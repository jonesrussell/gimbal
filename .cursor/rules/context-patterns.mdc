---
description: Context integration patterns for cancellation and timeouts
globs: ["**/managers/**/*.go", "**/game/**/*.go", "**/scenes/**/*.go"]
alwaysApply: false
---

# Context Integration Patterns

## Method Signatures
Context parameter always comes first after receiver:
```go
func (rm *ResourceManager) LoadSprite(ctx context.Context, name, path string) (*ebiten.Image, error)
```

## Initialization
Use `context.Background()` for startup operations:
```go
sprite, err := rm.LoadSprite(context.Background(), "player", "sprites/player.png")
```

## Timeouts
Use `context.WithTimeout()` for operations that may hang:
```go
ctx, cancel := context.WithTimeout(context.Background(), 5*time.Second)
defer cancel()
err := rm.LoadAllSprites(ctx)
```

## Cancellation Checks
Add in loops and before expensive operations:
```go
for _, item := range items {
    select {
    case <-ctx.Done():
        return ctx.Err()
    default:
    }
    // ... process item
}
```

## Interface Compliance
- All ResourceManager methods must match ResourceSystem interface
- Return errors when context operations can fail
- Check cancellation before expensive operations
