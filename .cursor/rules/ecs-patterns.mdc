---
description: ECS architecture patterns for Donburi framework
globs: ["**/ecs/**/*.go", "**/systems/**/*.go", "**/managers/**/*.go"]
alwaysApply: false
---

# ECS Architecture Patterns

## Component Management
- Use `core/components.go` as the single source of truth for component definitions
- Use Donburi's built-in component management, not custom registries
- Register new components: `MyComponent = donburi.NewComponentType[MyData]()`

## System Responsibilities
- **GameStateManager**: Core game state only (pause, game over, victory, timing)
- **ScoreManager**: All score-related functionality
- **LevelManager**: Level progression and difficulty
- **ResourceManager**: Sprite caching with context-aware loading
- **EventSystem**: Game event emission and subscription

## Query Patterns
```go
// Use queries for entity iteration
query := donburi.NewQuery(filter.Contains(core.Position, core.Sprite))
query.Each(world, func(entry *donburi.Entry) {
    pos := core.Position.Get(entry)
    // ...
})
```

## Constants
Extract magic numbers to `internal/ecs/constants.go` for ECS-specific values.
